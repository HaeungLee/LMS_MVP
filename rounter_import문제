1) 파일/패키지 이름 충돌

실제 구조가 app/api/v1/ai_learning/ 폴더(패키지) 이고, 그 안에 __init__.py만 있고 router를 내보내지 않으면,
import app.api.v1.ai_learning as ai_learning는 폴더 자체를 가리킵니다(= router 없음).

해결 A(권장): 명시적 임포트로 파일을 타게팅

# app/main.py
from app.api.v1.ai_learning import router as ai_learning_router
app.include_router(ai_learning_router, prefix="/api/v1/ai-learning", tags=["ai-learning"])


해결 B(패키지 방식 유지): app/api/v1/ai_learning/__init__.py에서 router를 노출

# app/api/v1/ai_learning/__init__.py
from .endpoints import router  # 예: 실제 라우터가 endpoints.py에 있다면
__all__ = ["router"]

2) 모듈 임포트 경로가 다른 파일을 가리킴

동일한 이름의 디렉터리/파일이 여러 군데 있거나, 작업 디렉터리가 엉켜 원치 않는 모듈이 임포트될 수 있습니다.

빠른 진단:

(venv) PS> python - << 'PY'
import importlib, app.api.v1.ai_learning as m
print("Loaded:", m.__file__)
print("Has router?", hasattr(m, "router"))
PY


여기서 router=False 이거나 __file__ 경로가 의도와 다르면 경로 충돌입니다.
→ 불필요한 동명 폴더/파일을 정리하거나, #1 처럼 명시적 파일 임포트로 고정하세요.

3) ai_learning.py 안에서 예외로 인해 router까지 도달 못함

보통은 ImportError가 떠야 하지만, 특정 상황(동적 임포트/재로더)에서 부분 임포트 후 속성 부재로 보일 때가 있습니다.

ai_learning.py 상단 임포트(예: from app.core.security import get_current_user, from app.models.orm import User, from app.services.ai_question_generator import ai_question_generator)에서 에러가 나면 router 정의까지 못 내려가요.

빠른 확인:

(venv) PS> python - << 'PY'
import traceback
try:
    import app.api.v1.ai_learning as m
    print("OK:", hasattr(m, "router"))
except Exception:
    traceback.print_exc()
PY


스택트레이스가 나오면 그 원인 임포트부터 해결하세요(경로/의존성/가상환경 확인).

4) 파일 저장/리로드 문제(윈도우+watchfiles)

코드 저장이 안 되었거나, 리로더가 캐시된 바이트코드를 보고 있을 수 있습니다.

조치:

에디터에서 저장 확인

__pycache__ 폴더 전체 삭제

리로더 옵션 바꿔 실행:

(venv) PS> python -m uvicorn app.main:app --reload --host 127.0.0.1 --port 8000 --reload-dir app


또는 임시로 --reload 끄고 기동해 임포트 에러를 명확히 보세요.

여러분 코드에 맞춘 “안전한” 적용 예시
(A) ai_learning이 단일 파일인 경우: app/api/v1/ai_learning.py
# app/api/v1/ai_learning.py
from fastapi import APIRouter, Depends, HTTPException, Query
# ...
router = APIRouter()
# ... (여러 엔드포인트들)

# app/main.py
from fastapi import FastAPI
from app.api.v1.ai_learning import router as ai_learning_router

app = FastAPI()
app.include_router(ai_learning_router, prefix="/api/v1/ai-learning", tags=["ai-learning"])

(B) ai_learning이 패키지인 경우: app/api/v1/ai_learning/
ai_learning/
  __init__.py
  endpoints.py   # 여기서 router 정의

# app/api/v1/ai_learning/endpoints.py
from fastapi import APIRouter, Depends, HTTPException, Query
# ...
router = APIRouter()
# ... (여러 엔드포인트들)

# app/api/v1/ai_learning/__init__.py
from .endpoints import router
__all__ = ["router"]

# app/main.py
from fastapi import FastAPI
from app.api.v1.ai_learning import router as ai_learning_router

app = FastAPI()
app.include_router(ai_learning_router, prefix="/api/v1/ai-learning", tags=["ai-learning"])

디버깅 체크리스트 (순서대로 해보세요)

어떤 모듈이 로드되는지 확인

(venv) PS> python - << 'PY'
import app.api.v1.ai_learning as m
print(m.__file__)
print("router?", hasattr(m, "router"))
PY


router=False면 #1~#2 원인에 해당 → 임포트/패키지 구조 수정.

예외 스택이 나오면 #3 원인 → 해당 임포트/종속성 해결.

그래도 안 되면 캐시/리로드(#4) 조치.

마지막으로 main.py에서 명시적 임포트로 고정:

from app.api.v1.ai_learning import router as ai_learning_router
app.include_router(ai_learning_router, prefix="/api/v1/ai-learning", tags=["ai-learning"])

추가 팁

라우터 변수명을 **반드시 router**로 통일(오타 주의).

중복 이름 피하기: 파일/폴더 이름을 ai_learning_api.py처럼 유니크하게.

패키지라면 __init__.py에 __all__ = ["router"]로 의도 명시.

Windows 경로에서 루트 기준 임포트가 어긋나지 않도록, uvicorn은 프로젝트 루트에서 실행.